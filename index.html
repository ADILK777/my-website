<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inheritance Planner | Unified Budget System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --cash: #2ecc71;         /* Green for Cash */
            --land: #d35400;         /* Orange for Land */
            --invest: #8e44ad;       /* Purple for Investing */
            --save: #16a085;         /* Teal for Savings */
            --spend: #3498db;        /* Blue for Spending */
            --car: #e74c3c;          /* Red for Car */
            --electronics: #f39c12;  /* Orange for Electronics */
            --home: #27ae60;         /* Green for Home */
            --danger: #c0392b;
            --success: #27ae60;
            --light: #f8f9fa;
            --dark: #2c3e50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #ecf0f1 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* HEADER */
        header {
            background: linear-gradient(135deg, var(--dark) 0%, #34495e 100%);
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 5px solid var(--cash);
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* UNIFIED SUMMARY */
        .unified-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 5px solid;
            transition: transform 0.3s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
        }
        
        .summary-card.cash {
            border-top-color: var(--cash);
        }
        
        .summary-card.land {
            border-top-color: var(--land);
        }
        
        .summary-card.total {
            border-top-color: var(--dark);
        }
        
        .summary-card.available {
            border-top-color: var(--spend);
        }
        
        .card-title {
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .card-value {
            font-size: 2rem;
            font-weight: 800;
        }
        
        .card-value.cash-value {
            color: var(--cash);
        }
        
        .card-value.land-value {
            color: var(--land);
        }
        
        .card-value.total-value {
            color: var(--dark);
        }
        
        .card-value.available-value {
            color: var(--spend);
        }
        
        /* TABS */
        .tabs {
            display: flex;
            background: white;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            margin-bottom: 0;
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            min-width: 180px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 700;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
        }
        
        .tab:hover {
            background: #f8f9ff;
            color: var(--dark);
        }
        
        .tab.active {
            color: white;
            border-bottom-color: transparent;
        }
        
        .tab.cash-tab.active {
            background: var(--cash);
        }
        
        .tab.land-tab.active {
            background: var(--land);
        }
        
        .tab.invest-tab.active {
            background: var(--invest);
        }
        
        .tab.save-tab.active {
            background: var(--save);
        }
        
        .tab.spend-tab.active {
            background: var(--spend);
        }
        
        .tab.purchase-tab.active {
            background: var(--car);
        }
        
        .tab-content {
            display: none;
            background: white;
            padding: 0;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: 600px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* TAB CONTENT LAYOUT */
        .tab-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }
        
        @media (max-width: 1100px) {
            .tab-container {
                grid-template-columns: 1fr;
            }
        }
        
        .left-panel, .right-panel {
            padding: 30px;
        }
        
        .left-panel {
            background: #f8f9ff;
            border-right: 2px solid #eee;
        }
        
        /* SECTION STYLES */
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.6rem;
            color: var(--dark);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title.cash-title {
            border-bottom-color: var(--cash);
        }
        
        .section-title.land-title {
            border-bottom-color: var(--land);
        }
        
        .section-title.invest-title {
            border-bottom-color: var(--invest);
        }
        
        .section-title.save-title {
            border-bottom-color: var(--save);
        }
        
        .section-title.spend-title {
            border-bottom-color: var(--spend);
        }
        
        .section-title.purchase-title {
            border-bottom-color: var(--car);
        }
        
        /* INPUT STYLES */
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }
        
        .input-group input {
            width: 100%;
            padding: 18px;
            border: 3px solid #ddd;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--spend);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        /* SLIDERS */
        .slider-container {
            margin: 30px 0;
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .slider-label {
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }
        
        .slider-value {
            font-weight: 800;
            font-size: 2rem;
        }
        
        .slider-value.invest-value {
            color: var(--invest);
        }
        
        .slider-value.save-value {
            color: var(--save);
        }
        
        input[type="range"] {
            width: 100%;
            height: 25px;
            -webkit-appearance: none;
            background: linear-gradient(to right, #e0e0e0, #e0e0e0);
            border-radius: 15px;
            outline: none;
        }
        
        #investSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--invest);
            cursor: pointer;
            border: 5px solid white;
            box-shadow: 0 0 15px rgba(142, 68, 173, 0.5);
            transition: all 0.3s ease;
        }
        
        #investSlider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.7);
        }
        
        #saveSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--save);
            cursor: pointer;
            border: 5px solid white;
            box-shadow: 0 0 15px rgba(22, 160, 133, 0.5);
            transition: all 0.3s ease;
        }
        
        #saveSlider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(22, 160, 133, 0.7);
        }
        
        /* UNIFIED BUDGET DISPLAY */
        .budget-overview {
            background: linear-gradient(135deg, var(--dark) 0%, #34495e 100%);
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .budget-title {
            font-size: 1.4rem;
            margin-bottom: 25px;
            text-align: center;
            opacity: 0.9;
        }
        
        .budget-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .budget-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .budget-item {
            text-align: center;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
        }
        
        .budget-label {
            font-size: 0.95rem;
            opacity: 0.8;
            margin-bottom: 10px;
        }
        
        .budget-value {
            font-size: 2rem;
            font-weight: 800;
        }
        
        /* ALLOCATION VISUAL */
        .allocation-visual {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin: 30px 0;
        }
        
        .allocation-bar {
            height: 40px;
            background: #f0f0f0;
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }
        
        .allocation-segments {
            display: flex;
            height: 100%;
        }
        
        .segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1rem;
            transition: all 0.5s ease;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        .segment.cash {
            background: var(--cash);
        }
        
        .segment.land {
            background: var(--land);
        }
        
        .segment.invest {
            background: var(--invest);
        }
        
        .segment.save {
            background: var(--save);
        }
        
        .segment.spend {
            background: var(--spend);
        }
        
        .segment.purchase {
            background: var(--car);
        }
        
        /* ALLOCATION CARDS */
        .allocation-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .allocation-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border-top: 6px solid;
            transition: transform 0.3s ease;
        }
        
        .allocation-card:hover {
            transform: translateY(-10px);
        }
        
        .allocation-card.cash-card {
            border-top-color: var(--cash);
        }
        
        .allocation-card.land-card {
            border-top-color: var(--land);
        }
        
        .allocation-card.invest-card {
            border-top-color: var(--invest);
        }
        
        .allocation-card.save-card {
            border-top-color: var(--save);
        }
        
        .allocation-card.spend-card {
            border-top-color: var(--spend);
        }
        
        .allocation-card.purchase-card {
            border-top-color: var(--car);
        }
        
        .allocation-card .amount {
            font-size: 2rem;
            font-weight: 900;
            margin: 15px 0;
        }
        
        .allocation-card.cash-card .amount {
            color: var(--cash);
        }
        
        .allocation-card.land-card .amount {
            color: var(--land);
        }
        
        .allocation-card.invest-card .amount {
            color: var(--invest);
        }
        
        .allocation-card.save-card .amount {
            color: var(--save);
        }
        
        .allocation-card.spend-card .amount {
            color: var(--spend);
        }
        
        .allocation-card.purchase-card .amount {
            color: var(--car);
        }
        
        /* MONTHLY EXPENSES */
        .monthly-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }
        
        .monthly-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--spend);
        }
        
        .monthly-item label {
            display: block;
            color: var(--dark);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .monthly-item input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark);
        }
        
        .monthly-item input:focus {
            outline: none;
            border-color: var(--spend);
        }
        
        /* PURCHASE FORM */
        .purchase-form {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--spend);
        }
        
        /* PURCHASE PREVIEW */
        .purchase-preview {
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 5px solid #f39c12;
        }
        
        .preview-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ffecb3;
        }
        
        .preview-row:last-child {
            border-bottom: none;
            font-weight: 800;
            font-size: 1.2rem;
        }
        
        /* BUTTONS */
        .btn {
            padding: 18px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .btn-cash {
            background: linear-gradient(135deg, var(--cash) 0%, #27ae60 100%);
            color: white;
        }
        
        .btn-land {
            background: linear-gradient(135deg, var(--land) 0%, #e67e22 100%);
            color: white;
        }
        
        .btn-invest {
            background: linear-gradient(135deg, var(--invest) 0%, #9b59b6 100%);
            color: white;
        }
        
        .btn-save {
            background: linear-gradient(135deg, var(--save) 0%, #1abc9c 100%);
            color: white;
        }
        
        .btn-purchase {
            background: linear-gradient(135deg, var(--car) 0%, #ff7675 100%);
            color: white;
        }
        
        /* RIGHT PANEL CONTENT */
        .chart-container {
            height: 300px;
            margin: 25px 0;
        }
        
        /* TIMELINE BOX */
        .timeline-box {
            background: linear-gradient(135deg, #e8f4fd 0%, #d6eaf8 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }
        
        .timeline-value {
            font-size: 3rem;
            font-weight: 900;
            margin: 20px 0;
            color: var(--dark);
        }
        
        /* ADVICE CONTAINER */
        .advice-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-top: 30px;
        }
        
        .advice-item {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 12px;
            border-left: 6px solid;
            background: #f8f9ff;
        }
        
        .advice-item.cash-advice {
            border-left-color: var(--cash);
        }
        
        .advice-item.land-advice {
            border-left-color: var(--land);
        }
        
        .advice-item.invest-advice {
            border-left-color: var(--invest);
        }
        
        .advice-item.save-advice {
            border-left-color: var(--save);
        }
        
        .advice-item.warning-advice {
            border-left-color: var(--danger);
        }
        
        /* PURCHASES TABLE */
        .purchases-table-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: var(--dark);
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 18px 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background-color: #f8f9ff;
        }
        
        /* CATEGORY TAGS */
        .category-tag {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            display: inline-block;
        }
        
        .category-car {
            background: rgba(231, 76, 60, 0.1);
            color: var(--car);
            border-left: 4px solid var(--car);
        }
        
        .category-electronics {
            background: rgba(243, 156, 18, 0.1);
            color: var(--electronics);
            border-left: 4px solid var(--electronics);
        }
        
        .category-home {
            background: rgba(39, 174, 96, 0.1);
            color: var(--home);
            border-left: 4px solid var(--home);
        }
        
        /* FOOTER */
        footer {
            text-align: center;
            padding: 30px;
            color: #666;
            font-size: 0.9rem;
            margin-top: 30px;
            border-top: 1px solid #eee;
        }
        
        /* EMPTY STATE */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* ANIMATIONS */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }
        
        /* BUDGET PROGRESS */
        .budget-progress {
            margin: 30px 0;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        }
        
        .progress-bar {
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #2ecc71);
            transition: width 0.5s ease;
        }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-money-bill-wave"></i> Unified Inheritance Budget System</h1>
            <p class="tagline">All your finances in one connected system - every change affects your total available cash</p>
        </header>
        
        <!-- UNIFIED BUDGET OVERVIEW -->
        <div class="budget-overview fade-in">
            <h2 class="budget-title">
                <i class="fas fa-chart-line"></i> Your Complete Budget Overview
            </h2>
            
            <div class="budget-grid">
                <div class="budget-item">
                    <div class="budget-label">Total Cash Inheritance</div>
                    <div class="budget-value" style="color: var(--cash);">DH <span id="unifiedCash">0</span></div>
                </div>
                
                <div class="budget-item">
                    <div class="budget-label">Total Land Value</div>
                    <div class="budget-value" style="color: var(--land);">DH <span id="unifiedLand">0</span></div>
                </div>
                
                <div class="budget-item">
                    <div class="budget-label">Total Allocated (Invest + Save)</div>
                    <div class="budget-value" style="color: var(--invest);">DH <span id="unifiedAllocated">0</span></div>
                </div>
                
                <div class="budget-item">
                    <div class="budget-label">Monthly Living Costs</div>
                    <div class="budget-value" style="color: var(--spend);">DH <span id="unifiedMonthly">0</span>/month</div>
                </div>
                
                <div class="budget-item">
                    <div class="budget-label">Planned Purchases</div>
                    <div class="budget-value" style="color: var(--car);">DH <span id="unifiedPurchases">0</span></div>
                </div>
                
                <div class="budget-item" style="background: rgba(255,255,255,0.2); border: 2px solid var(--success);">
                    <div class="budget-label">Available Cash After Everything</div>
                    <div class="budget-value" style="color: #ffffff; font-size: 2.2rem;">DH <span id="unifiedAvailable">0</span></div>
                </div>
            </div>
        </div>
        
        <!-- BUDGET PROGRESS -->
        <div class="budget-progress fade-in">
            <h3 style="color: var(--dark); margin-bottom: 15px;">
                <i class="fas fa-tachometer-alt"></i> Cash Usage Progress
            </h3>
            <div class="progress-bar">
                <div class="progress-fill" id="budgetProgress" style="width: 0%"></div>
            </div>
            <div class="progress-labels">
                <span>DH 0</span>
                <span id="progressUsed">DH 0 used</span>
                <span id="progressTotal">DH 0 total</span>
            </div>
        </div>
        
        <!-- TABS NAVIGATION -->
        <div class="tabs">
            <div class="tab cash-tab active" data-tab="cash">
                <i class="fas fa-money-bill-wave"></i> 1. Cash
            </div>
            <div class="tab land-tab" data-tab="land">
                <i class="fas fa-landmark"></i> 2. Land
            </div>
            <div class="tab invest-tab" data-tab="invest">
                <i class="fas fa-chart-line"></i> 3. Invest
            </div>
            <div class="tab save-tab" data-tab="save">
                <i class="fas fa-piggy-bank"></i> 4. Save
            </div>
            <div class="tab spend-tab" data-tab="spend">
                <i class="fas fa-calendar-alt"></i> 5. Monthly
            </div>
            <div class="tab purchase-tab" data-tab="purchase">
                <i class="fas fa-shopping-cart"></i> 6. Purchases
            </div>
        </div>
        
        <!-- CASH INHERITANCE TAB -->
        <div id="cash" class="tab-content active">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title cash-title">
                            <i class="fas fa-money-bill-wave"></i> Step 1: Enter Your Cash Inheritance
                        </h2>
                        
                        <div class="input-group">
                            <label for="cashAmount">Total Cash Inheritance (DH)</label>
                            <input type="number" id="cashAmount" placeholder="Enter cash amount you received" min="0" step="1000">
                            <small style="color: #7f8c8d; margin-top: 10px; display: block;">This is the starting point for all calculations</small>
                        </div>
                        
                        <div class="allocation-visual">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-chart-pie"></i> Cash Breakdown
                            </h3>
                            <div class="allocation-bar">
                                <div class="allocation-segments">
                                    <div class="segment cash" id="cashSegment" style="width: 100%">100% CASH</div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-cash" id="saveCashBtn">
                            <i class="fas fa-save"></i> Save & Continue
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title cash-title">
                            <i class="fas fa-chart-pie"></i> How Your Cash Will Be Used
                        </h2>
                        
                        <div class="chart-container">
                            <canvas id="cashChart"></canvas>
                        </div>
                        
                        <div class="allocation-cards">
                            <div class="allocation-card cash-card">
                                <div class="label">Your Cash</div>
                                <div class="amount">DH <span id="cashCardAmount">0</span></div>
                                <div class="percent" id="cashCardPercent">100%</div>
                            </div>
                            
                            <div class="allocation-card invest-card">
                                <div class="label">Will be Invested</div>
                                <div class="amount">DH <span id="cashInvestAmount">0</span></div>
                                <div class="percent" id="cashInvestPercent">0%</div>
                            </div>
                            
                            <div class="allocation-card save-card">
                                <div class="label">Will be Saved</div>
                                <div class="amount">DH <span id="cashSaveAmount">0</span></div>
                                <div class="percent" id="cashSavePercent">0%</div>
                            </div>
                            
                            <div class="allocation-card spend-card">
                                <div class="label">Will be Available</div>
                                <div class="amount">DH <span id="cashSpendAmount">0</span></div>
                                <div class="percent" id="cashSpendPercent">100%</div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title cash-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 1 of 6
                            </h3>
                            
                            <div id="cashAdvice">
                                <div class="advice-item cash-advice">
                                    <strong>üí∞ Start Here: Enter Your Cash</strong>
                                    <p>This is the actual money you have available. Every decision you make in the next steps will affect how much of this cash remains available for spending.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- LAND & PROPERTY TAB -->
        <div id="land" class="tab-content">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title land-title">
                            <i class="fas fa-landmark"></i> Step 2: Land & Property Value
                        </h2>
                        
                        <div class="input-group">
                            <label for="landValue">Market Value of Land/Property (DH)</label>
                            <input type="number" id="landValue" placeholder="Enter current market value" min="0" step="1000">
                            <small style="color: #7f8c8d; margin-top: 10px; display: block;">This adds to your total wealth but is not spendable cash</small>
                        </div>
                        
                        <div class="input-group">
                            <label for="landDescription">Description (Optional)</label>
                            <input type="text" id="landDescription" placeholder="e.g., Family land, House, Apartment">
                        </div>
                        
                        <div class="allocation-visual">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-chart-bar"></i> Total Wealth Breakdown
                            </h3>
                            <div class="allocation-bar">
                                <div class="allocation-segments">
                                    <div class="segment cash" id="landCashSegment" style="width: 100%">CASH</div>
                                    <div class="segment land" id="landLandSegment" style="width: 0%">LAND</div>
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 10px; font-size: 0.9rem; color: #7f8c8d;">
                                Total Value: DH <span id="totalValueDisplay">0</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-land" id="saveLandBtn">
                            <i class="fas fa-save"></i> Save & Continue
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title land-title">
                            <i class="fas fa-chart-pie"></i> Your Total Net Worth
                        </h2>
                        
                        <div class="chart-container">
                            <canvas id="landChart"></canvas>
                        </div>
                        
                        <div class="timeline-box fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-info-circle"></i> Land vs Cash
                            </h3>
                            
                            <div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Cash (Spendable):</span>
                                    <span style="font-weight: 700; color: var(--cash);">DH <span id="landCashAmount">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Land (Not Spendable):</span>
                                    <span style="font-weight: 700; color: var(--land);">DH <span id="landLandAmount">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-weight: 800; padding-top: 15px; border-top: 2px solid #eee;">
                                    <span>Total Net Worth:</span>
                                    <span style="color: var(--dark);">DH <span id="landTotalAmount">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title land-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 2 of 6
                            </h3>
                            
                            <div id="landAdvice">
                                <div class="advice-item land-advice">
                                    <strong>üè° Land Adds to Wealth, Not Cash</strong>
                                    <p>Land/property increases your total net worth but doesn't give you more spendable cash. You would need to sell it to convert to cash.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- INVESTING TAB -->
        <div id="invest" class="tab-content">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title invest-title">
                            <i class="fas fa-chart-line"></i> Step 3: Invest Your Cash
                        </h2>
                        
                        <div class="slider-container">
                            <div class="slider-header">
                                <div class="slider-label">
                                    <i class="fas fa-seedling"></i> Investment Percentage
                                </div>
                                <div class="slider-value invest-value" id="investPercent">0%</div>
                            </div>
                            <input type="range" id="investSlider" min="0" max="100" value="0" step="5">
                            <div style="text-align: center; margin-top: 15px; font-weight: 600; color: var(--invest); font-size: 1.2rem;">
                                DH <span id="investAmount">0</span> from cash for investing
                            </div>
                        </div>
                        
                        <div class="allocation-visual">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-chart-pie"></i> Cash Allocation After Investing
                            </h3>
                            <div class="allocation-bar">
                                <div class="allocation-segments">
                                    <div class="segment invest" id="investSegment" style="width: 0%">INVEST</div>
                                    <div class="segment save" id="saveSegment" style="width: 0%">SAVE</div>
                                    <div class="segment spend" id="spendSegment" style="width: 100%">SPEND</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="allocation-cards">
                            <div class="allocation-card invest-card">
                                <div class="label">Investing</div>
                                <div class="amount">DH <span id="investCardAmount">0</span></div>
                                <div class="percent" id="investCardPercent">0%</div>
                            </div>
                            
                            <div class="allocation-card save-card">
                                <div class="label">Savings</div>
                                <div class="amount">DH <span id="saveCardAmount">0</span></div>
                                <div class="percent" id="saveCardPercent">0%</div>
                            </div>
                            
                            <div class="allocation-card spend-card">
                                <div class="label">Available After This Step</div>
                                <div class="amount">DH <span id="spendCardAmount">0</span></div>
                                <div class="percent" id="spendCardPercent">100%</div>
                            </div>
                        </div>
                        
                        <button class="btn btn-invest" id="saveInvestBtn">
                            <i class="fas fa-save"></i> Save & Continue
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title invest-title">
                            <i class="fas fa-chart-pie"></i> Investment Impact
                        </h2>
                        
                        <div class="chart-container">
                            <canvas id="investChart"></canvas>
                        </div>
                        
                        <div class="timeline-box fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-calculator"></i> Investment Reduces Available Cash
                            </h3>
                            
                            <div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Your Cash:</span>
                                    <span style="font-weight: 700;">DH <span id="investBeforeCash">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Investment:</span>
                                    <span style="font-weight: 700; color: var(--danger);">-DH <span id="investDeduction">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Savings (next step):</span>
                                    <span style="font-weight: 700; color: #f39c12;">-DH <span id="investSaveDeduction">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-weight: 800; padding-top: 15px; border-top: 2px solid #eee;">
                                    <span>Remaining Cash:</span>
                                    <span style="color: var(--cash);">DH <span id="investRemainingCash">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title invest-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 3 of 6
                            </h3>
                            
                            <div id="investAdvice">
                                <div class="advice-item invest-advice">
                                    <strong>üìà Investment = Less Available Cash</strong>
                                    <p>Money you invest is no longer available for spending or purchases. It's allocated for long-term growth.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- SAVINGS TAB -->
        <div id="save" class="tab-content">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title save-title">
                            <i class="fas fa-piggy-bank"></i> Step 4: Emergency Savings
                        </h2>
                        
                        <div class="slider-container">
                            <div class="slider-header">
                                <div class="slider-label">
                                    <i class="fas fa-shield-alt"></i> Savings Percentage
                                </div>
                                <div class="slider-value save-value" id="savePercent">0%</div>
                            </div>
                            <input type="range" id="saveSlider" min="0" max="100" value="0" step="5">
                            <div style="text-align: center; margin-top: 15px; font-weight: 600; color: var(--save); font-size: 1.2rem;">
                                DH <span id="saveAmountDisplay">0</span> from cash for emergency fund
                            </div>
                        </div>
                        
                        <div class="allocation-visual">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-chart-pie"></i> Cash Allocation After Saving
                            </h3>
                            <div class="allocation-bar">
                                <div class="allocation-segments">
                                    <div class="segment invest" id="saveInvestSegment" style="width: 0%">INVEST</div>
                                    <div class="segment save" id="saveSaveSegment" style="width: 0%">SAVE</div>
                                    <div class="segment spend" id="saveSpendSegment" style="width: 100%">SPEND</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="allocation-cards">
                            <div class="allocation-card invest-card">
                                <div class="label">Investing</div>
                                <div class="amount">DH <span id="saveInvestCardAmount">0</span></div>
                                <div class="percent" id="saveInvestCardPercent">0%</div>
                            </div>
                            
                            <div class="allocation-card save-card">
                                <div class="label">Savings</div>
                                <div class="amount">DH <span id="saveSaveCardAmount">0</span></div>
                                <div class="percent" id="saveSaveCardPercent">0%</div>
                            </div>
                            
                            <div class="allocation-card spend-card">
                                <div class="label">Available After This Step</div>
                                <div class="amount">DH <span id="saveSpendCardAmount">0</span></div>
                                <div class="percent" id="saveSpendCardPercent">100%</div>
                            </div>
                        </div>
                        
                        <button class="btn btn-save" id="saveSavingsBtn">
                            <i class="fas fa-save"></i> Save & Continue
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title save-title">
                            <i class="fas fa-chart-pie"></i> Savings Impact
                        </h2>
                        
                        <div class="chart-container">
                            <canvas id="savingsChart"></canvas>
                        </div>
                        
                        <div class="timeline-box fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-calculator"></i> Available Cash After Investments & Savings
                            </h3>
                            
                            <div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Starting Cash:</span>
                                    <span style="font-weight: 700;">DH <span id="saveStartingCash">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Investments:</span>
                                    <span style="font-weight: 700; color: var(--invest);">-DH <span id="saveInvestDeduction">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Savings:</span>
                                    <span style="font-weight: 700; color: var(--save);">-DH <span id="saveSaveDeduction">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-weight: 800; padding-top: 15px; border-top: 2px solid #eee;">
                                    <span>Available for Living & Purchases:</span>
                                    <span style="color: var(--success);">DH <span id="saveAvailableCash">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title save-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 4 of 6
                            </h3>
                            
                            <div id="savingsAdvice">
                                <div class="advice-item save-advice">
                                    <strong>üõ°Ô∏è Savings = Less Available Cash</strong>
                                    <p>Emergency savings are important but reduce your available cash for monthly living and purchases.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- MONTHLY SPENDING TAB -->
        <div id="spend" class="tab-content">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title spend-title">
                            <i class="fas fa-file-invoice-dollar"></i> Step 5: Monthly Living Costs
                        </h2>
                        
                        <p style="color: #666; margin-bottom: 25px;">This will be deducted from your available cash every month.</p>
                        
                        <div class="monthly-grid">
                            <div class="monthly-item">
                                <label>üè† Rent / Mortgage</label>
                                <input type="number" id="monthlyRent" placeholder="0" min="0" step="100">
                            </div>
                            
                            <div class="monthly-item">
                                <label>üõí Food & Groceries</label>
                                <input type="number" id="monthlyFood" placeholder="0" min="0" step="50">
                            </div>
                            
                            <div class="monthly-item">
                                <label>üí° Utilities</label>
                                <input type="number" id="monthlyUtilities" placeholder="0" min="0" step="50">
                            </div>
                            
                            <div class="monthly-item">
                                <label>üöó Transportation</label>
                                <input type="number" id="monthlyTransport" placeholder="0" min="0" step="50">
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; font-size: 1.1rem;">
                                Other Monthly Expenses
                            </label>
                            <input type="number" id="monthlyOther" placeholder="Entertainment, subscriptions, etc." 
                                   style="width: 100%; padding: 18px; border: 3px solid #e0e0e0; border-radius: 12px; font-size: 1.2rem; font-weight: 600;">
                        </div>
                        
                        <div style="background: white; padding: 25px; border-radius: 15px; margin-top: 30px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.05);">
                            <div style="font-size: 1rem; color: #666;">Total Monthly Spending</div>
                            <div style="font-size: 3rem; font-weight: 900; color: var(--spend); margin: 15px 0;">
                                DH <span id="totalMonthlySpending">0</span>
                            </div>
                            <div style="font-size: 0.95rem; color: #999;">This will be deducted monthly from available cash</div>
                        </div>
                        
                        <button class="btn btn-invest" id="saveMonthlyBtn">
                            <i class="fas fa-save"></i> Save & Continue
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title spend-title">
                            <i class="fas fa-chart-pie"></i> Monthly Budget Impact
                        </h2>
                        
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                        
                        <div class="timeline-box fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-hourglass-half"></i> How Long Will Your Available Cash Last?
                            </h3>
                            
                            <div style="font-size: 1rem; color: #666; margin-bottom: 20px;">
                                With monthly spending of DH <span id="monthlyForTimeline">0</span>
                            </div>
                            
                            <div class="timeline-value" id="monthsLeft">
                                0 Months
                            </div>
                            
                            <div style="font-size: 1.3rem; color: #666;">
                                That's <span id="yearsLeft">0</span> years and <span id="extraMonths">0</span> months
                            </div>
                            
                            <div style="margin-top: 20px; padding: 15px; background: #fff8e1; border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Available Cash:</span>
                                    <span style="font-weight: 700;">DH <span id="monthlyAvailableCash">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                                    <span>Planned Purchases (next step):</span>
                                    <span style="font-weight: 700; color: var(--car);">-DH <span id="monthlyPurchases">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-top: 10px; font-weight: 800;">
                                    <span>Cash for Living:</span>
                                    <span style="color: var(--success);">DH <span id="monthlyCashForLiving">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title spend-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 5 of 6
                            </h3>
                            
                            <div id="spendingAdvice">
                                <div class="advice-item spend-advice">
                                    <strong>üí∞ Monthly Costs Reduce Available Cash</strong>
                                    <p>Your monthly living expenses will continuously reduce your available cash. Higher expenses mean your cash will run out faster.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- PURCHASES TAB -->
        <div id="purchase" class="tab-content">
            <div class="tab-container">
                <div class="left-panel">
                    <div class="section fade-in">
                        <h2 class="section-title purchase-title">
                            <i class="fas fa-cart-plus"></i> Step 6: Plan Your Purchases
                        </h2>
                        
                        <div class="purchase-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="purchaseName">What do you want to buy?</label>
                                    <input type="text" id="purchaseName" placeholder="e.g., New Car, iPhone, Furniture">
                                </div>
                                
                                <div class="form-group">
                                    <label for="purchaseAmount">Cost (DH)</label>
                                    <input type="number" id="purchaseAmount" placeholder="0" min="0" step="100">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="purchaseCategory">Category</label>
                                    <select id="purchaseCategory">
                                        <option value="Car">üöó Car / Vehicle</option>
                                        <option value="Electronics">üì± Electronics</option>
                                        <option value="Home">üè† Home & Furniture</option>
                                        <option value="Other">üì¶ Other</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="purchasePriority">Priority</label>
                                    <select id="purchasePriority">
                                        <option value="High">üî• High (Need Now)</option>
                                        <option value="Medium">‚ö° Medium (Need Soon)</option>
                                        <option value="Low">üå± Low (Can Wait)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="purchase-preview fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 20px;">
                                <i class="fas fa-calculator"></i> Purchase Impact on Your Budget
                            </h3>
                            
                            <div class="preview-row">
                                <span>Available Cash:</span>
                                <span style="font-weight: 700;">DH <span id="availableCash">0</span></span>
                            </div>
                            
                            <div class="preview-row">
                                <span>Current Planned Purchases:</span>
                                <span style="font-weight: 700; color: var(--car);">-DH <span id="currentPurchases">0</span></span>
                            </div>
                            
                            <div class="preview-row">
                                <span>This New Purchase:</span>
                                <span style="font-weight: 700; color: var(--danger);">-DH <span id="purchaseCost">0</span></span>
                            </div>
                            
                            <div class="preview-row">
                                <span>Remaining After All Purchases:</span>
                                <span style="font-weight: 700; color: var(--success);">DH <span id="remainingAfterPurchase">0</span></span>
                            </div>
                        </div>
                        
                        <button class="btn btn-purchase" id="addPurchaseBtn">
                            <i class="fas fa-plus-circle"></i> Add Purchase to List
                        </button>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="section fade-in">
                        <h2 class="section-title purchase-title">
                            <i class="fas fa-list-check"></i> Your Complete Purchase List
                        </h2>
                        
                        <div class="purchases-table-container">
                            <table id="purchasesTable">
                                <thead>
                                    <tr>
                                        <th>Item Name</th>
                                        <th>Cost (DH)</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="purchasesList">
                                    <tr id="emptyPurchases">
                                        <td colspan="5">
                                            <div class="empty-state">
                                                <i class="fas fa-shopping-cart"></i>
                                                <h3>No purchases yet</h3>
                                                <p>Add your first planned purchase</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="timeline-box fade-in">
                            <h3 style="color: var(--dark); margin-bottom: 15px;">
                                <i class="fas fa-check-circle"></i> Your Complete Budget Summary
                            </h3>
                            
                            <div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Starting Cash:</span>
                                    <span style="font-weight: 700;">DH <span id="summaryStartingCash">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Investments:</span>
                                    <span style="font-weight: 700; color: var(--invest);">-DH <span id="summaryInvest">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Savings:</span>
                                    <span style="font-weight: 700; color: var(--save);">-DH <span id="summarySave">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Minus Purchases:</span>
                                    <span style="font-weight: 700; color: var(--car);">-DH <span id="summaryPurchases">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-weight: 800; padding-top: 15px; border-top: 3px solid #eee; font-size: 1.2rem;">
                                    <span>Final Available Cash:</span>
                                    <span style="color: var(--success);">DH <span id="summaryFinalCash">0</span></span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-top: 15px; padding-top: 15px; border-top: 1px dashed #eee;">
                                    <span>Will Last:</span>
                                    <span style="font-weight: 700; color: var(--spend);" id="summaryMonthsLeft">0 months</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="advice-container fade-in">
                            <h3 class="section-title purchase-title" style="border: none; padding: 0;">
                                <i class="fas fa-lightbulb"></i> Step 6 of 6 - Complete!
                            </h3>
                            
                            <div id="purchaseAdvice">
                                <div class="advice-item invest-advice">
                                    <strong>‚úÖ Your Budget is Complete!</strong>
                                    <p>Every change you make in any section affects your final available cash. This is your unified budget system in action!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p><strong>Unified Inheritance Budget System</strong> | All sections are connected - every change updates your total available cash</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">Your data is saved automatically in your browser</p>
        </footer>
    </div>

    <script>
        // ========== GLOBAL VARIABLES ==========
        let financialData = {
            cash: 0,                // Actual cash inheritance
            land: 0,                // Value of land/property
            landDescription: "",    // Description of land
            investPercent: 0,       // % of cash to invest
            savePercent: 0,         // % of cash to save
            monthlyExpenses: {
                rent: 0,
                food: 0,
                utilities: 0,
                transport: 0,
                other: 0
            },
            purchases: []           // Planned purchases
        };
        
        let cashChart = null;
        let landChart = null;
        let investChart = null;
        let savingsChart = null;
        let monthlyChart = null;
        
        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            setupEventListeners();
            setupTabs();
            updateAllDisplays();
            updateCharts();
            updatePurchasePreview();
        });
        
        // ========== TAB SYSTEM ==========
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                    
                    // Update charts for the active tab
                    if (tabId === 'cash') updateCashChart();
                    if (tabId === 'land') updateLandChart();
                    if (tabId === 'invest') updateInvestChart();
                    if (tabId === 'save') updateSavingsChart();
                    if (tabId === 'spend') updateMonthlyChart();
                });
            });
        }
        
        // ========== EVENT LISTENERS ==========
        function setupEventListeners() {
            // Cash input
            document.getElementById('cashAmount').addEventListener('input', function() {
                financialData.cash = parseFloat(this.value) || 0;
                updateAllDisplays();
                updateCashChart();
                updateUnifiedBudget();
            });
            
            // Land value input
            document.getElementById('landValue').addEventListener('input', function() {
                financialData.land = parseFloat(this.value) || 0;
                updateAllDisplays();
                updateLandChart();
                updateUnifiedBudget();
            });
            
            // Land description input
            document.getElementById('landDescription').addEventListener('input', function() {
                financialData.landDescription = this.value;
                saveToLocalStorage();
            });
            
            // Invest slider
            const investSlider = document.getElementById('investSlider');
            investSlider.addEventListener('input', function() {
                financialData.investPercent = parseInt(this.value);
                document.getElementById('investPercent').textContent = `${financialData.investPercent}%`;
                
                // Adjust save slider if total exceeds 100%
                const total = financialData.investPercent + financialData.savePercent;
                if (total > 100) {
                    financialData.savePercent = 100 - financialData.investPercent;
                    document.getElementById('saveSlider').value = financialData.savePercent;
                    document.getElementById('savePercent').textContent = `${financialData.savePercent}%`;
                }
                
                updateAllDisplays();
                updateInvestChart();
                updateUnifiedBudget();
            });
            
            // Save slider
            const saveSlider = document.getElementById('saveSlider');
            saveSlider.addEventListener('input', function() {
                financialData.savePercent = parseInt(this.value);
                document.getElementById('savePercent').textContent = `${financialData.savePercent}%`;
                
                // Adjust invest slider if total exceeds 100%
                const total = financialData.investPercent + financialData.savePercent;
                if (total > 100) {
                    financialData.investPercent = 100 - financialData.savePercent;
                    document.getElementById('investSlider').value = financialData.investPercent;
                    document.getElementById('investPercent').textContent = `${financialData.investPercent}%`;
                }
                
                updateAllDisplays();
                updateSavingsChart();
                updateUnifiedBudget();
            });
            
            // Monthly expense inputs
            const monthlyInputs = ['rent', 'food', 'utilities', 'transport', 'other'];
            monthlyInputs.forEach(input => {
                document.getElementById(`monthly${input.charAt(0).toUpperCase() + input.slice(1)}`)
                    .addEventListener('input', function() {
                        financialData.monthlyExpenses[input] = parseFloat(this.value) || 0;
                        updateAllDisplays();
                        updateUnifiedBudget();
                    });
            });
            
            // Purchase amount input
            document.getElementById('purchaseAmount').addEventListener('input', function() {
                updatePurchasePreview();
            });
            
            // Save buttons
            document.getElementById('saveCashBtn').addEventListener('click', function() {
                saveToLocalStorage();
                showNotification('Cash inheritance saved!', 'cash');
            });
            
            document.getElementById('saveLandBtn').addEventListener('click', function() {
                saveToLocalStorage();
                showNotification('Land value saved!', 'land');
            });
            
            document.getElementById('saveInvestBtn').addEventListener('click', function() {
                saveToLocalStorage();
                showNotification('Investment plan saved!', 'invest');
            });
            
            document.getElementById('saveSavingsBtn').addEventListener('click', function() {
                saveToLocalStorage();
                showNotification('Savings plan saved!', 'save');
            });
            
            document.getElementById('saveMonthlyBtn').addEventListener('click', function() {
                saveToLocalStorage();
                showNotification('Monthly budget saved!', 'spend');
            });
            
            // Add purchase button
            document.getElementById('addPurchaseBtn').addEventListener('click', function() {
                addPurchase();
            });
        }
        
        // ========== CALCULATION FUNCTIONS ==========
        function calculateInvestAmount() {
            return (financialData.cash * financialData.investPercent) / 100;
        }
        
        function calculateSaveAmount() {
            return (financialData.cash * financialData.savePercent) / 100;
        }
        
        function calculateAvailableCash() {
            const investAmount = calculateInvestAmount();
            const saveAmount = calculateSaveAmount();
            return financialData.cash - investAmount - saveAmount;
        }
        
        function calculateTotalMonthlySpending() {
            const monthly = financialData.monthlyExpenses;
            return monthly.rent + monthly.food + monthly.utilities + monthly.transport + monthly.other;
        }
        
        function calculateTotalPurchases() {
            return financialData.purchases.reduce((total, purchase) => total + purchase.amount, 0);
        }
        
        function calculateRemainingAfterPurchases() {
            const availableCash = calculateAvailableCash();
            const totalPurchases = calculateTotalPurchases();
            return availableCash - totalPurchases;
        }
        
        function calculateMonthsLeft() {
            const monthlySpending = calculateTotalMonthlySpending();
            const remainingAfterPurchases = calculateRemainingAfterPurchases();
            
            if (monthlySpending <= 0) return 0;
            
            return remainingAfterPurchases / monthlySpending;
        }
        
        function calculateTotalInheritance() {
            return financialData.cash + financialData.land;
        }
        
        function calculateTotalAllocated() {
            return calculateInvestAmount() + calculateSaveAmount();
        }
        
        // ========== DISPLAY UPDATES ==========
        function updateAllDisplays() {
            const investAmount = calculateInvestAmount();
            const saveAmount = calculateSaveAmount();
            const availableCash = calculateAvailableCash();
            const totalPurchases = calculateTotalPurchases();
            const remainingAfterPurchases = calculateRemainingAfterPurchases();
            const monthlySpending = calculateTotalMonthlySpending();
            const monthsLeft = calculateMonthsLeft();
            const totalAllocated = calculateTotalAllocated();
            
            // Update unified budget display
            document.getElementById('unifiedCash').textContent = financialData.cash.toLocaleString();
            document.getElementById('unifiedLand').textContent = financialData.land.toLocaleString();
            document.getElementById('unifiedAllocated').textContent = totalAllocated.toLocaleString();
            document.getElementById('unifiedMonthly').textContent = monthlySpending.toLocaleString();
            document.getElementById('unifiedPurchases').textContent = totalPurchases.toLocaleString();
            document.getElementById('unifiedAvailable').textContent = remainingAfterPurchases.toLocaleString();
            
            // Update cash tab displays
            document.getElementById('cashCardAmount').textContent = financialData.cash.toLocaleString();
            document.getElementById('cashInvestAmount').textContent = investAmount.toLocaleString();
            document.getElementById('cashSaveAmount').textContent = saveAmount.toLocaleString();
            document.getElementById('cashSpendAmount').textContent = availableCash.toLocaleString();
            document.getElementById('cashInvestPercent').textContent = `${financialData.investPercent}%`;
            document.getElementById('cashSavePercent').textContent = `${financialData.savePercent}%`;
            document.getElementById('cashSpendPercent').textContent = `${100 - financialData.investPercent - financialData.savePercent}%`;
            
            // Update land tab displays
            document.getElementById('landCashAmount').textContent = financialData.cash.toLocaleString();
            document.getElementById('landLandAmount').textContent = financialData.land.toLocaleString();
            document.getElementById('landTotalAmount').textContent = calculateTotalInheritance().toLocaleString();
            document.getElementById('totalValueDisplay').textContent = calculateTotalInheritance().toLocaleString();
            
            // Update invest tab displays
            document.getElementById('investAmount').textContent = investAmount.toLocaleString();
            document.getElementById('investCardAmount').textContent = investAmount.toLocaleString();
            document.getElementById('saveInvestCardAmount').textContent = investAmount.toLocaleString();
            document.getElementById('investCardPercent').textContent = `${financialData.investPercent}%`;
            document.getElementById('saveInvestCardPercent').textContent = `${financialData.investPercent}%`;
            
            document.getElementById('investBeforeCash').textContent = financialData.cash.toLocaleString();
            document.getElementById('investDeduction').textContent = investAmount.toLocaleString();
            document.getElementById('investSaveDeduction').textContent = saveAmount.toLocaleString();
            document.getElementById('investRemainingCash').textContent = availableCash.toLocaleString();
            
            // Update savings tab displays
            document.getElementById('saveAmountDisplay').textContent = saveAmount.toLocaleString();
            document.getElementById('saveCardAmount').textContent = saveAmount.toLocaleString();
            document.getElementById('saveSaveCardAmount').textContent = saveAmount.toLocaleString();
            document.getElementById('saveCardPercent').textContent = `${financialData.savePercent}%`;
            document.getElementById('saveSaveCardPercent').textContent = `${financialData.savePercent}%`;
            
            document.getElementById('saveStartingCash').textContent = financialData.cash.toLocaleString();
            document.getElementById('saveInvestDeduction').textContent = investAmount.toLocaleString();
            document.getElementById('saveSaveDeduction').textContent = saveAmount.toLocaleString();
            document.getElementById('saveAvailableCash').textContent = availableCash.toLocaleString();
            
            const spendPercent = 100 - financialData.investPercent - financialData.savePercent;
            document.getElementById('spendCardAmount').textContent = availableCash.toLocaleString();
            document.getElementById('saveSpendCardAmount').textContent = availableCash.toLocaleString();
            document.getElementById('spendCardPercent').textContent = `${spendPercent}%`;
            document.getElementById('saveSpendCardPercent').textContent = `${spendPercent}%`;
            
            // Update allocation bars
            updateAllocationBars();
            
            // Update monthly tab displays
            updateMonthlyDisplay();
            
            // Update months left display
            updateMonthsDisplay(monthsLeft);
            
            // Update purchase displays
            updatePurchasePreview();
            updatePurchasesTable();
            
            // Update budget progress
            updateBudgetProgress();
            
            // Update summary section
            updateSummarySection();
        }
        
        function updateUnifiedBudget() {
            // This function ensures the unified budget display is always up to date
            updateAllDisplays();
        }
        
        function updateAllocationBars() {
            // Cash tab allocation
            const cashSegment = document.getElementById('cashSegment');
            cashSegment.style.width = '100%';
            cashSegment.textContent = '100% CASH';
            
            // Land tab allocation
            const totalInheritance = calculateTotalInheritance();
            const cashPercent = totalInheritance > 0 ? (financialData.cash / totalInheritance) * 100 : 0;
            const landPercent = totalInheritance > 0 ? (financialData.land / totalInheritance) * 100 : 0;
            
            document.getElementById('landCashSegment').style.width = `${cashPercent}%`;
            document.getElementById('landLandSegment').style.width = `${landPercent}%`;
            
            if (cashPercent > 10) document.getElementById('landCashSegment').textContent = `${Math.round(cashPercent)}% CASH`;
            if (landPercent > 10) document.getElementById('landLandSegment').textContent = `${Math.round(landPercent)}% LAND`;
            
            // Invest/Save tabs allocation
            const investPercent = financialData.investPercent;
            const savePercent = financialData.savePercent;
            const spendPercent = 100 - investPercent - savePercent;
            
            // Invest tab segments
            document.getElementById('investSegment').style.width = `${investPercent}%`;
            document.getElementById('saveSegment').style.width = `${savePercent}%`;
            document.getElementById('spendSegment').style.width = `${spendPercent}%`;
            
            if (investPercent > 10) document.getElementById('investSegment').textContent = `${investPercent}% INVEST`;
            if (savePercent > 10) document.getElementById('saveSegment').textContent = `${savePercent}% SAVE`;
            if (spendPercent > 10) document.getElementById('spendSegment').textContent = `${spendPercent}% SPEND`;
            
            // Save tab segments
            document.getElementById('saveInvestSegment').style.width = `${investPercent}%`;
            document.getElementById('saveSaveSegment').style.width = `${savePercent}%`;
            document.getElementById('saveSpendSegment').style.width = `${spendPercent}%`;
            
            if (investPercent > 10) document.getElementById('saveInvestSegment').textContent = `${investPercent}% INVEST`;
            if (savePercent > 10) document.getElementById('saveSaveSegment').textContent = `${savePercent}% SAVE`;
            if (spendPercent > 10) document.getElementById('saveSpendSegment').textContent = `${spendPercent}% SPEND`;
            
            // Hide segments if width is too small
            const segments = document.querySelectorAll('.segment');
            segments.forEach(segment => {
                const width = parseFloat(segment.style.width) || 0;
                segment.style.display = width < 5 ? 'none' : 'flex';
            });
        }
        
        function updateMonthlyDisplay() {
            const totalMonthly = calculateTotalMonthlySpending();
            document.getElementById('totalMonthlySpending').textContent = totalMonthly.toLocaleString();
            document.getElementById('monthlyForTimeline').textContent = totalMonthly.toLocaleString();
            
            const availableCash = calculateAvailableCash();
            const totalPurchases = calculateTotalPurchases();
            
            document.getElementById('monthlyAvailableCash').textContent = availableCash.toLocaleString();
            document.getElementById('monthlyPurchases').textContent = totalPurchases.toLocaleString();
            document.getElementById('monthlyCashForLiving').textContent = (availableCash - totalPurchases).toLocaleString();
        }
        
        function updateMonthsDisplay(months) {
            const monthsLeftElement = document.getElementById('monthsLeft');
            const yearsLeftElement = document.getElementById('yearsLeft');
            const extraMonthsElement = document.getElementById('extraMonths');
            
            if (months === Infinity || months > 120) {
                monthsLeftElement.textContent = "‚àû Months";
                yearsLeftElement.textContent = "‚àû";
                extraMonthsElement.textContent = "0";
                monthsLeftElement.style.color = "#27ae60"; // Green
            } else if (months >= 0) {
                const years = Math.floor(months / 12);
                const extraMonths = Math.floor(months % 12);
                
                monthsLeftElement.textContent = `${Math.floor(months)} Months`;
                yearsLeftElement.textContent = years;
                extraMonthsElement.textContent = extraMonths;
                
                // Color coding based on months left
                if (months < 6) {
                    monthsLeftElement.style.color = "#c0392b"; // Red
                } else if (months < 12) {
                    monthsLeftElement.style.color = "#f39c12"; // Orange
                } else {
                    monthsLeftElement.style.color = "#27ae60"; // Green
                }
            } else {
                monthsLeftElement.textContent = "0 Months";
                yearsLeftElement.textContent = "0";
                extraMonthsElement.textContent = "0";
                monthsLeftElement.style.color = "#c0392b"; // Red
            }
        }
        
        function updatePurchasePreview() {
            const purchaseAmount = parseFloat(document.getElementById('purchaseAmount').value) || 0;
            const availableCash = calculateAvailableCash();
            const currentPurchases = calculateTotalPurchases();
            const remaining = availableCash - currentPurchases - purchaseAmount;
            
            document.getElementById('availableCash').textContent = availableCash.toLocaleString();
            document.getElementById('currentPurchases').textContent = currentPurchases.toLocaleString();
            document.getElementById('purchaseCost').textContent = purchaseAmount.toLocaleString();
            document.getElementById('remainingAfterPurchase').textContent = remaining.toLocaleString();
            
            // Color code remaining amount
            const remainingEl = document.getElementById('remainingAfterPurchase');
            if (remaining < 0) {
                remainingEl.style.color = "#c0392b"; // Red
            } else if (remaining < (financialData.cash * 0.1)) {
                remainingEl.style.color = "#f39c12"; // Yellow
            } else {
                remainingEl.style.color = "#27ae60"; // Green
            }
        }
        
        function updateBudgetProgress() {
            const totalCash = financialData.cash;
            const allocated = calculateInvestAmount() + calculateSaveAmount();
            const purchases = calculateTotalPurchases();
            const used = allocated + purchases;
            const progressPercent = totalCash > 0 ? (used / totalCash) * 100 : 0;
            
            document.getElementById('budgetProgress').style.width = `${progressPercent}%`;
            document.getElementById('progressUsed').textContent = `DH ${used.toLocaleString()} used`;
            document.getElementById('progressTotal').textContent = `DH ${totalCash.toLocaleString()} total`;
            
            // Color code progress bar
            const progressBar = document.getElementById('budgetProgress');
            if (progressPercent > 90) {
                progressBar.style.background = "linear-gradient(90deg, #c0392b, #e74c3c)";
            } else if (progressPercent > 70) {
                progressBar.style.background = "linear-gradient(90deg, #f39c12, #f1c40f)";
            } else {
                progressBar.style.background = "linear-gradient(90deg, var(--success), #2ecc71)";
            }
        }
        
        function updateSummarySection() {
            const startingCash = financialData.cash;
            const investAmount = calculateInvestAmount();
            const saveAmount = calculateSaveAmount();
            const purchases = calculateTotalPurchases();
            const finalCash = calculateRemainingAfterPurchases();
            const monthsLeft = calculateMonthsLeft();
            
            document.getElementById('summaryStartingCash').textContent = startingCash.toLocaleString();
            document.getElementById('summaryInvest').textContent = investAmount.toLocaleString();
            document.getElementById('summarySave').textContent = saveAmount.toLocaleString();
            document.getElementById('summaryPurchases').textContent = purchases.toLocaleString();
            document.getElementById('summaryFinalCash').textContent = finalCash.toLocaleString();
            
            const monthsText = monthsLeft === Infinity || monthsLeft > 120 ? 
                "‚àû months" : 
                `${Math.floor(monthsLeft)} months`;
            document.getElementById('summaryMonthsLeft').textContent = monthsText;
        }
        
        // ========== PURCHASE FUNCTIONS ==========
        function addPurchase() {
            const name = document.getElementById('purchaseName').value.trim();
            const amount = parseFloat(document.getElementById('purchaseAmount').value) || 0;
            const category = document.getElementById('purchaseCategory').value;
            const priority = document.getElementById('purchasePriority').value;
            
            if (!name) {
                showNotification('Please enter a purchase name', 'warning');
                return;
            }
            
            if (amount <= 0) {
                showNotification('Please enter a valid cost', 'warning');
                return;
            }
            
            // Check if we have enough cash
            const available = calculateAvailableCash();
            const currentPurchases = calculateTotalPurchases();
            const remaining = available - currentPurchases;
            
            if (amount > remaining) {
                if (!confirm(`This purchase costs DH ${amount.toLocaleString()} but you only have DH ${remaining.toLocaleString()} available after current purchases. Add it anyway?`)) {
                    return;
                }
            }
            
            const purchase = {
                id: Date.now(),
                name: name,
                amount: amount,
                category: category,
                priority: priority,
                date: new Date().toISOString().split('T')[0]
            };
            
            financialData.purchases.push(purchase);
            
            // Clear form
            document.getElementById('purchaseName').value = '';
            document.getElementById('purchaseAmount').value = '';
            
            saveToLocalStorage();
            updateAllDisplays();
            updatePurchasePreview();
            updatePurchasesTable();
            
            showNotification(`Purchase added! Affects your available cash.`, 'success');
        }
        
        function deletePurchase(id) {
            if (confirm('Are you sure you want to delete this purchase?')) {
                financialData.purchases = financialData.purchases.filter(p => p.id !== id);
                saveToLocalStorage();
                updateAllDisplays();
                updatePurchasesTable();
                
                showNotification('Purchase deleted - available cash updated', 'success');
            }
        }
        
        function updatePurchasesTable() {
            const tbody = document.getElementById('purchasesList');
            const emptyRow = document.getElementById('emptyPurchases');
            
            // Clear table
            tbody.innerHTML = '';
            
            if (financialData.purchases.length === 0) {
                tbody.appendChild(emptyRow);
                emptyRow.style.display = '';
                return;
            }
            
            emptyRow.style.display = 'none';
            
            // Sort purchases by priority (High first) then amount (descending)
            const sortedPurchases = [...financialData.purchases].sort((a, b) => {
                const priorityOrder = { 'High': 1, 'Medium': 2, 'Low': 3 };
                if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                    return priorityOrder[a.priority] - priorityOrder[b.priority];
                }
                return b.amount - a.amount;
            });
            
            // Add purchases to table
            sortedPurchases.forEach(purchase => {
                const row = document.createElement('tr');
                
                // Get category class
                let categoryClass = 'category-other';
                switch(purchase.category) {
                    case 'Car': categoryClass = 'category-car'; break;
                    case 'Electronics': categoryClass = 'category-electronics'; break;
                    case 'Home': categoryClass = 'category-home'; break;
                }
                
                // Get priority badge
                let priorityBadge = '';
                switch(purchase.priority) {
                    case 'High': priorityBadge = '<span style="color: #e74c3c; font-weight: 700;">üî• High</span>'; break;
                    case 'Medium': priorityBadge = '<span style="color: #f39c12; font-weight: 700;">‚ö° Medium</span>'; break;
                    case 'Low': priorityBadge = '<span style="color: #27ae60; font-weight: 700;">üå± Low</span>'; break;
                }
                
                row.innerHTML = `
                    <td>
                        <strong>${purchase.name}</strong>
                    </td>
                    <td><strong>DH ${purchase.amount.toLocaleString()}</strong></td>
                    <td><span class="category-tag ${categoryClass}">${purchase.category}</span></td>
                    <td>${priorityBadge}</td>
                    <td>
                        <button onclick="deletePurchase(${purchase.id})" style="background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // ========== CHARTS ==========
        function updateCharts() {
            updateCashChart();
            updateLandChart();
            updateInvestChart();
            updateSavingsChart();
            updateMonthlyChart();
        }
        
        function updateCashChart() {
            const ctx = document.getElementById('cashChart')?.getContext('2d');
            if (!ctx) return;
            
            if (cashChart) {
                cashChart.destroy();
            }
            
            const investAmount = calculateInvestAmount();
            const saveAmount = calculateSaveAmount();
            const spendAmount = calculateAvailableCash();
            
            cashChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Will Invest', 'Will Save', 'Will Be Available'],
                    datasets: [{
                        data: [investAmount, saveAmount, spendAmount],
                        backgroundColor: [
                            'rgba(142, 68, 173, 0.9)',
                            'rgba(22, 160, 133, 0.9)',
                            'rgba(52, 152, 219, 0.9)'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 14, weight: '600' }
                            }
                        }
                    }
                }
            });
        }
        
        function updateLandChart() {
            const ctx = document.getElementById('landChart')?.getContext('2d');
            if (!ctx) return;
            
            if (landChart) {
                landChart.destroy();
            }
            
            const cash = financialData.cash;
            const land = financialData.land;
            
            landChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Cash (Spendable)', 'Land (Not Spendable)'],
                    datasets: [{
                        data: [cash, land],
                        backgroundColor: [
                            'rgba(46, 204, 113, 0.9)',
                            'rgba(211, 84, 0, 0.9)'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 14, weight: '600' }
                            }
                        }
                    }
                }
            });
        }
        
        function updateInvestChart() {
            const ctx = document.getElementById('investChart')?.getContext('2d');
            if (!ctx) return;
            
            if (investChart) {
                investChart.destroy();
            }
            
            const investAmount = calculateInvestAmount();
            const saveAmount = calculateSaveAmount();
            const spendAmount = calculateAvailableCash();
            
            investChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Investing', 'Savings', 'Available to Spend'],
                    datasets: [{
                        data: [investAmount, saveAmount, spendAmount],
                        backgroundColor: [
                            'rgba(142, 68, 173, 0.9)',
                            'rgba(22, 160, 133, 0.9)',
                            'rgba(52, 152, 219, 0.9)'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 14, weight: '600' }
                            }
                        }
                    }
                }
            });
        }
        
        function updateSavingsChart() {
            const ctx = document.getElementById('savingsChart')?.getContext('2d');
            if (!ctx) return;
            
            if (savingsChart) {
                savingsChart.destroy();
            }
            
            const saveAmount = calculateSaveAmount();
            const monthlyExpenses = calculateTotalMonthlySpending();
            const sixMonthGoal = monthlyExpenses * 6;
            
            savingsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Your Emergency Fund', '6-Month Goal'],
                    datasets: [{
                        label: 'Amount (DH)',
                        data: [saveAmount, sixMonthGoal],
                        backgroundColor: [
                            'rgba(22, 160, 133, 0.9)',
                            'rgba(52, 152, 219, 0.9)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'DH' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateMonthlyChart() {
            const ctx = document.getElementById('monthlyChart')?.getContext('2d');
            if (!ctx) return;
            
            if (monthlyChart) {
                monthlyChart.destroy();
            }
            
            const monthly = financialData.monthlyExpenses;
            
            monthlyChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Rent', 'Food', 'Utilities', 'Transport', 'Other'],
                    datasets: [{
                        data: [monthly.rent, monthly.food, monthly.utilities, monthly.transport, monthly.other],
                        backgroundColor: [
                            '#ff6b6b',
                            '#4cd964',
                            '#5ac8fa',
                            '#ff9500',
                            '#af52de'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                padding: 20,
                                font: { size: 12 }
                            }
                        }
                    }
                }
            });
        }
        
        // ========== DATA PERSISTENCE ==========
        function saveToLocalStorage() {
            localStorage.setItem('unifiedBudgetData', JSON.stringify(financialData));
        }
        
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('unifiedBudgetData');
            if (savedData) {
                financialData = JSON.parse(savedData);
                
                // Update form fields
                document.getElementById('cashAmount').value = financialData.cash;
                document.getElementById('landValue').value = financialData.land;
                document.getElementById('landDescription').value = financialData.landDescription || '';
                
                // Update sliders
                document.getElementById('investSlider').value = financialData.investPercent;
                document.getElementById('saveSlider').value = financialData.savePercent;
                
                // Update slider displays
                document.getElementById('investPercent').textContent = `${financialData.investPercent}%`;
                document.getElementById('savePercent').textContent = `${financialData.savePercent}%`;
                
                // Update monthly expenses
                document.getElementById('monthlyRent').value = financialData.monthlyExpenses.rent;
                document.getElementById('monthlyFood').value = financialData.monthlyExpenses.food;
                document.getElementById('monthlyUtilities').value = financialData.monthlyExpenses.utilities;
                document.getElementById('monthlyTransport').value = financialData.monthlyExpenses.transport;
                document.getElementById('monthlyOther').value = financialData.monthlyExpenses.other;
            }
        }
        
        // ========== NOTIFICATIONS ==========
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            
            let bgColor = '#3498db';
            let icon = 'fa-info-circle';
            
            switch(type) {
                case 'cash': bgColor = '#2ecc71'; icon = 'fa-money-bill-wave'; break;
                case 'land': bgColor = '#d35400'; icon = 'fa-landmark'; break;
                case 'invest': bgColor = '#8e44ad'; icon = 'fa-chart-line'; break;
                case 'save': bgColor = '#16a085'; icon = 'fa-piggy-bank'; break;
                case 'spend': bgColor = '#3498db'; icon = 'fa-dollar-sign'; break;
                case 'success': bgColor = '#27ae60'; icon = 'fa-check-circle'; break;
                case 'warning': bgColor = '#f39c12'; icon = 'fa-exclamation-triangle'; break;
            }
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 18px 25px;
                border-radius: 12px;
                box-shadow: 0 8px 25px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                display: flex;
                align-items: center;
                gap: 12px;
                font-weight: 600;
                max-width: 400px;
            `;
            
            notification.innerHTML = `
                <i class="fas ${icon}" style="font-size: 1.3rem;"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            // Add CSS animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                    if (style.parentNode) {
                        document.head.removeChild(style);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
